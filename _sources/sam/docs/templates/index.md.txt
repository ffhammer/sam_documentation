# Stress Addition Model (SAM)


This is a Python reimplementation of the Stress Addition Model (SAM) from the research paper "Predicting the synergy of multiple stress effects" by Matthias Liess, Kaarina Foit, Saskia Knillmann, Ralf B. Schäfer, and Hans-Dieter Liess.

## Documentation

[To the package Documentation](https://ffhammer.github.io/sam_documentation/)

## ECx-SyS model
[ECx-SyS model Prediction Page](ecx_sys.md)

## Increase in Toxicant Sensitivity with Increased Environmental Stress

We generated these graphics using different settings by modifying the **E parameter** of the fitted LL5 model. This was done by multiplying it with what we currently refer to as the **"E Parameter Factor"**.

Before computing the stress of the control, adding environmental stress, and generating our SAM prediction, we modify the LL5 model of the control by setting its new parameter as follows:

$$
\text{new\_E\_parameter} = \text{old\_E\_parameter} \times \text{E\_Fac}
$$

### Sensitivity Increase with Different E Parameter Factors

- **[Original / E Factor = 1](imgs/increase_in_lcs/sensitivity_increase_original.html)**
- **[E Factor = 0.25 for outliers](imgs/increase_in_lcs/sensitivity_increase_e_fac_0.25.html)**
- **[E Factor = optimal for outliers](imgs/increase_in_lcs/sensitivity_increase_e_fac_optimal_outliers.html)**
- **[E Factor = optimal for all datapoints](imgs/increase_in_lcs/sensitivity_increase_e_fac_optimal_all.html)**

### Normalization by Effect Range

Additionally, we attempted to normalize the increase in toxicant sensitivity by the **steepness of the curve**. As a proxy for this, we used a measure called the **effect range**, defined as:
$$
\text{Effect Range} = \frac{LC_{75}}{LC_{25}}
$$

This represents the span of the toxicant concentration from **75% to 25% lethality**.

We then normalized the increase in toxicant sensitivity by dividing it by the effect range:

- **[Original / E Factor = 1](imgs/increase_in_lcs/sensitivity_increase_effect_range_normed_original.html)**
- **[E Factor = 0.25 for outliers](imgs/increase_in_lcs/sensitivity_increase_effect_range_normed_e_fac_0.25.html)**
- **[E Factor = optimal for outliers](imgs/increase_in_lcs/sensitivity_increase_effect_range_normed_e_fac_optimal_outliers.html)**
- **[E Factor = optimal for all datapoints](imgs/increase_in_lcs/sensitivity_increase_effect_range_normed_e_fac_optimal_all.html)**


## Visualizing Dose-Response Fits Across Experiments

This section visualizes dose-response fits across all experiments. Each curve is projected into a "normalized" scale, where lethal concentrations (LCs) range from LC1 to LC99, enabling effective comparisons between experiments.

- **[Raw Dose-Response Curves](imgs/dose_response_curves/raw_dosecurves.html)**  
This visualization shows the unprocessed dose-response fits for each experiment, as generated by the `sam.dose_response_fit` method, without any adjustments.

- **[Cleaned Dose-Response Curves](imgs/dose_response_curves/cleaned_dosecurves.html)**  
This visualization shows "cleaned" dose-response curves, where system-inherent stress effects have been removed. Subhormesis points are dropped, and the control survival rate is set to 100%, providing a clearer view of the dose-response relationship in isolation.
- **[Cleaned Dose-Response Curves LC 25-75](imgs/dose_response_curves/cleaned_dosecurves_25_75.html)**  
  
## Experiments

The following is a list of individual experiments conducted, each with detailed data and SAM model predictions:

{% for experiment in experiments %}
- [{{ experiment.nicer_name }}](experiments/{{ experiment.experiment_link }})
{% endfor %}

## Citation
```bibtex
@Manual{,
    title = {stressaddition: Modelling Tri-Phasic Concentration-Response Relationships},
    author = {Sebastian Henz and Matthias Liess},
    year = {2020},
    note = {R package version 3.1.0},
    url = {https://CRAN.R-project.org/package=stressaddition},
}
```


## Copyright and License

Copyright (c) 2020,  
Helmholtz-Zentrum fuer Umweltforschung GmbH - UFZ.  
All rights reserved.

The code is a property of:

Helmholtz-Zentrum fuer Umweltforschung GmbH - UFZ  
Registered Office: Leipzig  
Registration Office: Amtsgericht Leipzig  
Trade Register: Nr. B 4703  
Chairman of the Supervisory Board: MinDirig’in Oda Keppler  
Scientific Director: Prof. Dr. Georg Teutsch  
Administrative Director: Dr. Sabine König

SAM (Stress Addition Model) is free software: you can redistribute it and/or modify  
it under the terms of the GNU General Public License as published by  
the Free Software Foundation, either version 3 of the License, or  
(at your option) any later version.

This program is distributed in the hope that it will be useful,  
but WITHOUT ANY WARRANTY; without even the implied warranty of  
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the  
GNU General Public License for more details.

You should have received a copy of the GNU General Public License  
along with this program. If not, see <https://www.gnu.org/licenses/>.